# 分页组件的简单理解

首先我需要明确，我确实还是不太懂这玩意儿的原理，但是总算搞懂了怎么用，希望后面有人能告诉我他的实现原理，这样比手动写要方便的多

* 首先我们需要先引入

  > ```python
  > from django.core.paginator import Paginator, EmptyPage, PageNotAnInteger
  > ```

* 然后核心代码如下所示

  - 后端

    > ```python
    > students = models.students.objects.all()
    > paginator = Paginator(students, 8)
    > page = request.GET.get('page')
    > page_obj = paginator.get_page(page)
    > return render(request, 'index.html', {'page_obj': page_obj})
    > ```

  - 前端，添加在需要显示分页位置的地方

    > ```html
    > <div class="pagination">
    >     <span class="step-links">
    >         {% if page_obj.has_previous %}
    >             <a href="?page=1">&laquo; first</a>
    >             <a href="?page={{ page_obj.previous_page_number }}">previous</a>
    >         {% endif %}
    > 
    >         <span class="current">
    >             Page {{ page_obj.number }} of {{ page_obj.paginator.num_pages }}.
    >         </span>
    > 
    >         {% if page_obj.has_next %}
    >             <a href="?page={{ page_obj.next_page_number }}">next</a>
    >             <a href="?page={{ page_obj.paginator.num_pages }}">last &raquo;</a>
    >         {% endif %}
    >     </span>
    > </div>
    > ```
    >
    > 以下为bootstrap美化过的版本，直接用
    >
    > ```html
    > <div class="text-center">
    >     <ul class="pagination">
    >         <!-- 首页链接-->
    >         {% if page_obj.has_previous %}
    >             <li>
    >                 <a href="?page=1" aria-label="First">&laquo;</a>
    >             </li>
    >             <li>
    >                 <a href="?page={{ page_obj.previous_page_number }}" aria-label="Previous">&lsaquo;</a>
    >             </li>
    >         {% endif %}
    >         <li class="active">
    >             <span>当前第 {{ page_obj.number }} 页 总共 {{ page_obj.paginator.num_pages }} 页</span>
    >         </li>
    >     
    >         {% if page_obj.has_next %}
    >             <li>
    >                 <a href="?page={{ page_obj.next_page_number }}" aria-label="Next">&rsaquo;</a>
    >             </li>
    >             <li>
    >                 <a href="?page={{ page_obj.paginator.num_pages }}" aria-label="Last">&raquo;</a>
    >             </li>
    >         {% endif %}
    >     </ul>
    > </div>
    > ```

* 简单的解释

  * 首先我们获取全部的`queryset`对象`students = models.students.objects.all()`
  * 然后将其传给分页对象，并指定每页显示数据条目`paginator = Paginator(students, 8)`
  * 然后就获取页码，这也是我最难以理解的地方，明明我前端没有写任何`/?page=x`的链接，他是怎么获取这个数据的呢，我没写它又该怎么返回呢？反正这么写就对了`page = request.GET.get('page')`
  * 然后将分页完成的数据传给一个对象`page_obj`，`page_obj = paginator.get_page(page)`
  * 最后将其返回给前端界面`return render(request, 'index.html', {'page_obj': page_obj})`
  * 前端界面上只需要将如上代码直接放在自己需要显示的地方即可。好看点可以自己加bootstrap样式